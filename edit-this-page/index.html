<!DOCTYPE html>
<html>
  <head>
    <title>Edit This Page</title>
    <link rel="stylesheet" href="/core.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-77118590-7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-77118590-7');
    </script>

    <style>
      #dont-click-message {
        display: none;
      }
      #installation-congrats {
        position: absolute;

        text-align: center;
        top: 0;
        left: 0;

        width: 100%;
        height: 100%;

        background-color: black;
        color: white;
        opacity: 0.9;

        display: none;
      }

      .rainbow {
        animation: rainbow 10s linear 0s infinite;
      }
    </style>

    <style>
      @keyframes rainbow {
        0% {
            color: #F00;
        }
        17% {
            color: #FF0;
        }
        33% {
            color: #0F0;
        }
        50% {
            color: #0FF;
        }
        67% {
            color: #00F;
        }
        84% {
            color: #F0F;
        }
        100% {
            color: #F00;
        }
      }
    </style>
  </head>

  <body>
    <h1>Edit This Page (v0.3)</h1>
    <hr>
    <p>A simple bookmark that lets you edit the text of any website!</p>
    <p>A continuation of a chrome extension that was removed from the chrome web store.</p>
    <p>This is really a dumbed down version of <a href="https://goggles.mozilla.org/">X-Ray Goggles by Mozilla</a>.</p>

    <h2>Installation</h2>
    <p>
      <b>
        Drag the following link onto your bookmarks bar:
        <a onclick="return showDontClickMessage();" id="install-button">Edit This Page</a>
      </b>
    </p>
    <p id="dont-click-message" class="rainbow">Don't click on it, drag it onto your bookmarks bar!</p>
    <p>You may have to enable your bookmarks bar, that depend son the browser. It's in the settings somewhere.</p>

    <h2>Usage</h2>
    <p>
      After installation simply click on the bookmark to edit the page.
    </p>
    <p>
      Each time you run it it will toggle between editable and not editable allowing you to make things seem legit.
    </p>

    <h2>Bugs</h2>
    <p>On sites such as YouTube typing triggers other events.</p>

    <div id="installation-congrats">
      <h1>Congrats!</h1>
      <p>Edit This Page is installed correctly and is working. It's really that easy.</p>
      <p>Try editing this text.</p>
      <p>(you won't see this message on other sites, only this one)</p>
      <button onclick="hideInstallMessage();">Hide This Message</button>
    </div>

    </div>

    <script>
      var dev = true;
      var host = dev ? "http://localhost:8080" : "https://garbomuffin.github.io";
      var scriptSource = host + "/edit-this-page/edit-this-page.js";

      var js = [
        "var script=document.createElement('script');",
        "script.src='" + scriptSource + "?' + Math.random();",
        "document.body.appendChild(script)",
      ].join("");

      var installButton = document.getElementById("install-button");
      installButton.href = `javascript:(function(){${js}}());`;

      function showDontClickMessage() {
        var el = document.getElementById("dont-click-message");
        if (el.style.display === "") {
          el.style.display = "inline";
        } else {
          var fontSize = window.getComputedStyle(el).fontSize.match(/\d*/)[0];
          var fontSizeNumber = Number(fontSize);
          el.style.fontSize = (fontSizeNumber * 1.1) + "px";
        }
        return false;
      }

      function hideInstallMessage() {
        document.getElementById("installation-congrats").style.display = "none";
      }

      var installCheckInterval = setInterval(function () {
        if (window.__editThisPageLoaded) {
          document.getElementById("installation-congrats").style.display = "block";
          clearInterval(installCheckInterval);
        }
      }, 100);
    </script>
  </body>
</html>
