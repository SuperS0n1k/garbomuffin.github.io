<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="style.css">
    <title>Nightlight</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
  </head>

  <body>
    <img src="assets/site/nightlight.png" height="32" alt="Nightlight">

    <p>
      <a href="https://scratch.mit.edu/projects/150752251/">Play the original</a>
      by <a href="https://scratch.mit.edu/users/TriforceMayhem/">TriforceMayhem</a>.
      Assets are used with permission and licensed under the <a href="https://creativecommons.org/licenses/by-sa/2.0/">Creative Commons Attribution-ShareAlike 2.0 license</a> (as per Scratch terms).
    </p>

    <div id="container">
      <div id="canvas">
        <div id="menu-container">
          <div id="menu-background"><img src="assets/thumb.png" width="100%"></div>
          <div id="loading-screen" class="menu">
            <img src="assets/site/loading.png">
          </div>
          <div id="menu-screen" class="menu">
            <div><button id="play-button">Start Game</button></div>
            <div><button id="load-code-button">Load Level Code</button></div>
            <div><button id="load-code-url-button">Load Level Code From URL</button></div>
          </div>
          <div id="loading-screen-progress-bar" class="progress-bar">
            <div class="progress-bar-inside" id="progress-bar"></div>
          </div>
        </div>
      </div>

      <div id="level-editor-ui" class="level-editor-ui">
        <label>
          Mode:
          <select id="level-editor-option-mode">
            <option selected value="0">Block</option>
            <option value="1">Jumpy Bois</option>
            <option value="2">Text</option>
            <option value="3">Boss</option>
            <option value="4">Player Spawn</option>
          </select>
        </label>

        <div id="level-editor-mode-block" class="level-editor-mode">
          <div><b>Active block:</b> (<span id="level-editor-active-block-description"></span>)</div>
          <div>
            <img id="level-editor-active-block-image">
          </div>
  
          <div id="level-editor-block-gallery"></div>
        </div>

        <div id="level-editor-mode-text" class="level-editor-mode">
          <div>
            <label>Snap to grid: <input id="level-editor-text-snap" type="checkbox" checked></label>
          </div>
          <br>
          <div>
            <b>Left click on empty space</b> to place text.<br>
            <b>Left click</b> on an existing text to change its text.<br>
            <b>Right click</b> on an existing text to remove it.<br>
            <b>Middle click</b> on an existing text to move it.<br>
            <small>You may have to click twice for mouse actions to register.</small>
          </div>
        </div>

        <div id="level-editor-mode-jump-lights" class="level-editor-mode">
          <div>
            <label>Snap to grid: <input id="level-editor-jump-lights-snap" type="checkbox" checked></label>
          </div>
          <br>
          <div>
            <b>Left click on empty space</b> to place a jumpy boi.<br>
            <b>Left click</b> on an existing jumpy boi to move/remove it (keeps outline).<br>
            <b>Right click</b> on an existing jumpy boi to remove it.
          </div>
        </div>

        <div id="level-editor-mode-boss" class="level-editor-mode">
          <label>
            Boss:
            <select id="level-editor-boss-selection">
              <option value="" selected>None</option>
              <option value="sword">Sword</option>
              <option value="noss1">Noss 1</option>
              <option value="noss2">Noss 2</option>
            </select>
          </label>

          <div id="level-editor-boss-sword">
            <div>
              <label>Health: <input id="level-editor-boss-sword-health" type="number" min="0" value="3"></label>
            </div>
            <div>
              <label>Blocks from top: <input id="level-editor-boss-sword-blocks-from-top" type="number" min="0" max="23" value="14"></label>
            </div>
          </div>
          <div id="level-editor-boss-noss1"></div>
          <div id="level-editor-boss-noss2"></div>

          <p><b>More options soon<sup>TM</sup>.</b></p>
        </div>

        <div id="level-editor-mode-spawn" class="level-editor-mode">
          <div>
            <label>
              Spawn:
              <select id="level-editor-spawn-select">
                <option value="default" selected>Default</option>
                <option value="random">Random</option>
                <option value="range">Range</option>
                <option value="point">Point</option>
              </select>
            </label>
          </div>
          <div>
            <label>
              Always show spawn <small>(useless for default)</small>:
              <input type="checkbox" id="level-editor-spawn-always-show">
            </label>
          </div>

          <div id="level-editor-spawn-random">
            <div><label>Min X: <input type="number" value="0" min="0" max="480" id="level-editor-spawn-random-min-x"></label></div>
            <div><label>Max X: <input type="number" value="480" min="0" max="480" id="level-editor-spawn-random-max-x"></label></div>
            <div><label>Min Y: <input type="number" value="0" min="0" max="360" id="level-editor-spawn-random-min-y"></label></div>
            <div><label>Max Y: <input type="number" value="360" min="0" max="360" id="level-editor-spawn-random-max-y"></label></div>
          </div>

          <div id="level-editor-spawn-range">
            <div><label>Min X: <input type="number" value="0" min="0" max="480" id="level-editor-spawn-range-min-x"></label></div>
            <div><label>Max X: <input type="number" value="480" min="0" max="480" id="level-editor-spawn-range-max-x"></label></div>
            <div><label>Require solid block: <input type="checkbox" checked id="level-editor-spawn-range-solid"></label></div>
          </div>

          <div id="level-editor-spawn-point">
            <div><label>X: <input type="number" value="0" min="0" max="480" id="level-editor-spawn-point-x"></label></div>
            <div><label>Y: <input type="number" value="344" min="0" max="360" id="level-editor-spawn-point-y"></label></div>
            <div><button id="level-editor-spawn-point-select">Select a point</button></div>
            <div><label>Algin Selection <input type="checkbox" checked id="level-editor-spawn-point-select-align"></label></div>
          </div>
        </div>

        <hr>

        <div>
          <button id="level-editor-get-code">Get Code</button>
          <button id="level-editor-get-json-code">Get JSON</button>
          <button id="level-editor-open-level">Open Level</button>
          <button id="level-editor-import-code">Import</button>
          <div><textarea id="level-editor-code-output" readonly onclick="this.focus();this.select();"></textarea></div>
        </div>

        <hr>

        <div id="level-editor-options">
          <div><label>Dark:<input id="level-editor-option-dark" type="checkbox"></label></div>
          <div><label>Stars:<input id="level-editor-option-stars" type="checkbox" checked></label></div>
          <div>
            <label>
              Background:
              <select id="level-editor-option-background">
                <option selected value="black">Black</option>
                <option value="castle">Castle</option>
              </select>
            </label>
          </div>
          <div>
            <label>
              Music:
              <select id="level-editor-option-music">
                <option selected value="music/exploration">Exploration</option>
                <option value="music/blackroad/1,music/blackroad/2">Black Road</option>
                <option value="music/boss/1,music/boss/2">Boss</option>
                <option value="music/netherslament">Nether's Lament</option>
                <option value="music/challenge">Challenge</option>
                <option value="music/finalboss/1,music/finalboss/2">Final Boss</option>
              </select>
            </label>
          </div>
        </div>
      </div>
    </div>

    <div id="volume-container"><label>Volume: <input type="range" min="0" max="100" id="volume"></label><span id="volume-level"></span></div>

    <div id="level-editor-welcome" style="display: none;">
      <div id="level-editor-welcome-content">
        <div>
          <b>Welcome to the level editor!</b>
        </div>
        <div>
          <small>Further documentation may be written at a later date.</small>
        </div>
        <br>
        <div>
          Save your levels with the "Get JSON" button <small>(save the stuff in the textbox somewhere)</small>
          and can be imported using the "Import" button.
        </div>
      </div>

      <div>
        <small><a id="level-editor-welcome-toggle" href="#" onclick="return false;">hide welcome text</a></small>
      </div>
    </div>

    <div id="cb">
      <button onclick="runtime.level++;runtime.renderLevel();">Next level</button>
      <button onclick="runtime.level--;runtime.renderLevel();">Prev level</button>
    </div>
    <script>document.getElementById("cb").style.display=location.hash==="#cheaty-boi"?"":"none"</script>

    <pre id="changelog">
      <b>Changelog:</b>
      7/10/2018:
       * <span title="doot doot">ðŸŽºðŸŽº</span>

      7/9/2018:
       * <a onclick="alert('Maybe something will happen if you beat the game and click at the very end?');return false;" href="#">ðŸ¤”</a>

      v0.1.9.4 (6/17/2018):
       * Fix some firefox issues
       * Make castle background brick darker to better contrast regular bricks
       * Fix final boss coin spawning
       * Changes to level 14 (for consistency. purely aesthetic)
       * You can play it on a mobile device if you like to torture yourself. (move finger right to move right, left to move left, to upper part of game to jump)

      6/16/2018:
       * Made the site less ugly

      v0.1.9.3:
       * Added back the "jump delay" <span style="color:white">that never existed</span>

      v0.1.9.2:
       * Game should load faster on slow connections
       * Sword boss: made the death animation longer
       * Sword boss: coin flies up from the pit
       * Sword boss: music ends when the sword dies
       * Final boss: hitbox fixed
       * Remember that secret new feature? It's pretty lit. Shame I can't share it yet.

      v0.1.9.1:
       * Fix that one OOB glitch, again
       * Fix Firefox compatibility

      v0.1.9:
       * Made boss collision testing around 60% faster
       * And a secret new feature...

      v0.1.8:
       * Around 50% performance gain (in average frame time on the first level)
       * Optimized star rendering (again, but its actually really fast this time)
       * Optimized grass rendering (made it static)
       * Optimized corner rendering (made it static)
       * Optimized rendering as a whole
       * Sword rotates around the correct point

      v0.1.7:
       * Average frame times seem to be around 15% lower than before
       * Star rendering greatly optimized.
         You'd be surprised how long they took to render. Seriously.
       * Rewrote large portions of collision testing to not be slow as hell.
         There could be problems, please tell me.
       * Sprites are only sorted if they have to be sorted.
       * Crumbling blocks reset instantly on death
       * Jump lights reset instantly on death
       * Removed shortcut to get to the end using a link
       * Other potential optimizations

      v0.1.6:
       * Sword boss: fixed animation length
       * Bridge level: blocks fall instantly so you have to actually use the dots
       * Implemented pause (Escape)
       * Implemented level codes
       * Changed loading screen

      v0.1.5:
       * Last boss: player spawns in random locations to fix "hold up to win"
       * Last boss: correct background image and stars
       * Last boss: other behavior corrections
       * Ending: images alligned correctly
       * Sword boss: behavior corrections

      v0.1.4:
       * Death resets levels (to some degree)
       * Other bug fixes

      v0.1.3:
       * Ending

      v0.1.2:
       * Improved loading screen
       * Basic start menu
       * Text in levels
       * Fixed hit sound timing in sword boss

      v0.1.0.1:
       * Make Reilly triggered.

      v0.1:
       * fixed being able to do up to 3 hits in one cycle on the second boss
       * really, I just want to be done with this.

      v0.0.999.2:
       * Volume slider won't crash the game and doesn't start out on 0.5%.
       * Even Reilly should be able to beat the second boss now.
        * YOU HAVE AN ENTIRE FIVE SECONDS TO HIT THE THING NOW I THINK YOU CAN DO IT
       * Fixed some delays during the second boss.

      v0.0.999.1:
       * Added just about all sounds
       * Boss paterns are just about perfect

      v0.0.999.0:
       * Added the last boss

      v0.0.9.5:
       * Things that are scaled will still look pixelated
       * Added debug tools
       * Volume slider that starts at 50%

      v0.0.9.4:
       * Rendering optimizations of nearly 2x in some cases
       * Collision optimized
        * Death pieces can now in some cases have almost no performance impact
       * Fixed some bugs from the previous version

      v0.0.9.3:
       * Noss bullets don't render rotated
       * 100 background stars instead of 50
       * Light block toggle switches now show up again when you hit another one
       * You now won't ever float when skipping around levels
       * Stop button stops audio
       * Other bug fixes

      v0.0.9.2:
       * Second boss's bullets actually glide to the center
       * Second boss has hit effects
       * Hit effects improved
       * Pressing stop stops audio
       * Boss coins are centered properly
       * Other minor garbage

      v0.0.9.1:
       * Second boss nearly done

      v0.0.9:
       * Sword boss runs almost perfectly on a chromebook
       * Sword boss becomes vulnerable at the right time
       * Second boss very early implementation

      Pre v0.0.9:
       * no one knows
    </pre>
    <script>
      (function() {
        const el = document.getElementById("changelog");
        el.innerHTML = el.innerHTML.split("\n").map((i) => i.replace(/^ {6}/giu, "")).join("\n");
      }());
    </script>
    <script src="dist/bundle.js"></script>
  </body>
</html>
